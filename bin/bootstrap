#!/usr/bin/env bash

set -e

python=python3
${python} -c 'import sys; sys.exit(sys.version_info.major<3)'
${python} -c 'import sys; sys.exit(sys.version_info.minor<8)'

relpath() { python -c "import os; print(os.path.relpath('$1', '$2'))"; }

root=$(dirname $BASH_SOURCE)/..
venv=${1:-${root}/venv}
test -d ${venv} || ${python} -m venv ${venv}
source ${venv}/bin/activate
python -m pip install wheel

site=$(python -c 'import site; _,=site.getsitepackages(); print(_)')
ln -sf $(relpath ${root}/lib/mypf ${site}) ${site}
